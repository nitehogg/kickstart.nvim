export SESSION_COLOR_OFFSET=1

function nv() {

  COMMAND="$1"

  if [ $COMMAND == 'add' ]
  then
    NEW_PATH="$2"
    nv_add "$NEW_PATH"
  fi

  nv_new "$1"
}

function nv_add() {
# session_name path
# if no session_name provided, use latest
  exit 0
}

function nv_new() {
  OLD_PWD="$(pwd)"

  if [ -f "$1" ]
  then
    FILE_PATH="$1"
    SESSION_PATH="$(dirname $1)"
    SESSION_NAME="$SESSION_PATH"
  elif [ -d "$1" ]
  then
    SESSION_PATH="$1"
    SESSION_NAME="$SESSION_PATH"
  else
    SESSION_PATH="${2:-$(pwd)}"
    SESSION_NAME="$1"
  fi
  
  cd "$SESSION_PATH"

  tmux new-session -s "$SESSION_NAME" -n "$(pwd)" -y- -d nvim "$FILENAME"
  tmux source-file ~/.tmux-ide.conf 
  tmux set-option status-bg "color$SESSION_COLOR_OFFSET"

  export SESSION_COLOR_OFFSET=$(($SESSION_COLOR_OFFSET + 10))

  tmux attach

  cd "$OLD_PWD"

  exit 0 
}

alias nv="nv"

# (add | new | else new)
# add (session | latest) path
# new name? (file | path)
# move setup to own file... source in rc
